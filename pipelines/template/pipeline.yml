# parameters:
---
  parameters:
    - name: PythonVersion
      type: string 
      values:
        - '3.9'
        - '3.10'
        - '3.11'
        - '3.12'
        - '3.13'
      default: '3.11'


  stages:
  - stage: "LinterStage"
    pool:
      vmImage: ubuntu-latest
    jobs:
    - job: InstallPython
      steps:
        - task: UsePythonVersion@0
          inputs:
            versionSpec: ${{ parameters.PythonVersion }}
          displayName: 'Use Python ${{ parameters.PythonVersion }}'
    - job: InstallLinters
      dependsOn: InstallPython
      steps:
        - script: |
            python -m pip install flake8
          displayName: "Install Flake8"
        - script: |
            python -m pip install mypy
          displayName: "Install mypy"
    - job: RunLinters
      dependsOn: InstallLinters
      steps:
        - bash: |
            echo "Running linter..."
            pwd
            ls
            mypy ./
            flake8 ./
          displayName: "Linter Run"
  - stage: "UnitTestingStage"
    dependsOn: LinterStage
    pool:
      vmImage: ubuntu-latest
    jobs:
    - job: InstallPython
      steps:
        - task: UsePythonVersion@0
          inputs:
            versionSpec: ${{ parameters.PythonVersion }}
          displayName: 'Use Python ${{ parameters.PythonVersion }}'
    - job: InstallDependencies
      dependsOn: InstallPython
      steps:
        - script: |
            python -m pip install -r requirements.txt
          displayName: "Install Python Depenencies"
    - job: RunUnitTests
      dependsOn: InstallDependencies
      steps:
        - bash: |
            echo "Running tests..."
            # python test.py
          displayName: "Run Unit Tests"
  - stage: "DeploymentApprovalStage"
    dependsOn: UnitTestingStage
    pool:
      vmImage: ubuntu-latest
    jobs:
    - job: DeploymentApprovalJob
      steps:
        - task: ManualValidation@1
          inputs:
            timeoutInMinutes: 5
  - stage: "DeploymentStage"
    dependsOn: DeploymentApprovalStage
    pool:
      vmImage: ubuntu-latest
    jobs:
    - job: InstallPython
      steps:
        - task: UsePythonVersion@0
          inputs:
            versionSpec: ${{ parameters.PythonVersion }}
          displayName: 'Use Python ${{ parameters.PythonVersion }}'
    - job: InstallDependencies
      dependsOn: InstallPython
      steps:
        - script: |
            python -m pip install -r requirements.txt
          displayName: "Install Python Depenencies"
    - job: RunDeployment
      dependsOn: InstallDependencies
      steps:
        - bash: |
            echo "Running Deployment..."
            # python test.py
          displayName: "Run Deployments"
